package model;

import org.junit.Assert;
import org.junit.Test;

import java.sql.Timestamp;

import static org.junit.Assert.assertEquals;

/**
 * Tests for NvdVulnerability Model
 */
public class NvdVulnerabilityTest {

    @Test
    public void testNvdVulnReceived() {

        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test", Timestamp.valueOf("2023-05-20 00:00:00"), null,"Received");
        Assert.assertEquals("CVE-Test", testVuln.getCveId());
        Assert.assertEquals(Timestamp.valueOf("2023-05-20 00:00:00"), testVuln.getPublishDate());
        assertEquals(NvdVulnerability.nvdStatus.RECEIVED, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnUndergoingAnalysis() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"), null,"Undergoing Analysis");
        assertEquals(NvdVulnerability.nvdStatus.UNDERGOINGANALYSIS, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnAwaitingAnalysis() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"), null, "Awaiting Analysis");
        assertEquals(NvdVulnerability.nvdStatus.AWAITINGANALYSIS, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnAnalyzed() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"), null, "Analyzed");
        assertEquals(NvdVulnerability.nvdStatus.ANALYZED, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnNotInNvd() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"), null,"nostatus");
        assertEquals(NvdVulnerability.nvdStatus.NOTINNVD, testVuln.getStatus());
    }

}
