package model;

import org.junit.jupiter.api.Test;

import java.sql.Timestamp;

import static org.junit.jupiter.api.Assertions.*;

class VulnerabilityTest {

    private final String dummyCveId;
    private final String dummyDescription;
    private final Timestamp dummyPubDate;
    private final Timestamp dummyModDate;
    private final Timestamp dummyCreateDate;

    VulnerabilityTest() {
        dummyCveId = "CVE-xxxx-xxx";
        dummyDescription = "vulnerability description";
        long current = System.currentTimeMillis();
        dummyPubDate = new Timestamp(current);
        dummyModDate = new Timestamp (3600L*1000 + current);
        dummyCreateDate = new Timestamp(3600L*2000 + current);
    }


    private Vulnerability genVuln() {
        return new Vulnerability(dummyCveId, dummyDescription, dummyPubDate, dummyModDate, dummyCreateDate);
    }

    @Test
    void constructorTest() {
        Vulnerability vuln = genVuln();
        assertEquals(dummyCveId, vuln.getCveId());
        assertEquals(dummyDescription, vuln.getDescription());
        assertEquals(dummyPubDate, vuln.getPublishDate());
        assertEquals(dummyModDate, vuln.getLastModifiedDate());
        assertEquals(dummyCreateDate, vuln.getCreateDate());
    }

    @Test
    void getCveId() {
        Vulnerability vuln = genVuln();
        assertEquals(dummyCveId, vuln.getCveId());
    }

    @Test
    void getDescription() {
        Vulnerability vuln = genVuln();
        assertEquals(dummyDescription, vuln.getDescription());
    }

    @Test
    void getPublishDate() {
        Vulnerability vuln = genVuln();
        assertEquals(dummyPubDate, vuln.getPublishDate());
    }

    @Test
    void getLastModifiedDate() {
        Vulnerability vuln = genVuln();
        assertEquals(dummyModDate, vuln.getLastModifiedDate());
    }

    @Test
    void getCreateDate() {
        Vulnerability vuln = genVuln();
        assertEquals(dummyCreateDate, vuln.getCreateDate());
    }
}