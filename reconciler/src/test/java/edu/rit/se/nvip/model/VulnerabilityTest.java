package edu.rit.se.nvip.model;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import java.sql.Timestamp;

class VulnerabilityTest {

    private final String dummyCveId;
    private final String dummyDescription;
    private final Timestamp dummyPubDate;
    private final Timestamp dummyModDate;
    private final Timestamp dummyCreateDate;
    /**
     * verifies all methods from  vulnerability work as intended
     */
    VulnerabilityTest() {
        dummyCveId = "CVE-xxxx-xxx";
        dummyDescription = "vulnerability description";
        long current = System.currentTimeMillis();
        dummyPubDate = new Timestamp(current);
        dummyModDate = new Timestamp (3600L*1000 + current);
        dummyCreateDate = new Timestamp(3600L*2000 + current);
    }


    private Vulnerability genVuln() {
        return new Vulnerability(dummyCveId, dummyDescription, dummyPubDate, dummyModDate, dummyCreateDate);
    }

    @Test
    void constructorTest() {
        Vulnerability vuln = genVuln();
        Assertions.assertEquals(dummyCveId, vuln.getCveId());
        Assertions.assertEquals(dummyDescription, vuln.getDescription());
        Assertions.assertEquals(dummyPubDate, vuln.getPublishDate());
        Assertions.assertEquals(dummyModDate, vuln.getLastModifiedDate());
        Assertions.assertEquals(dummyCreateDate, vuln.getCreateDate());
        Vulnerability vuln2 = new Vulnerability(1, dummyCveId, dummyDescription, 0, 0, dummyCreateDate);
        Assertions.assertEquals(1, vuln2.getVulnID());
        Assertions.assertEquals(dummyCveId, vuln2.getCveId());
        Assertions.assertEquals(dummyDescription, vuln2.getDescription());
        Assertions.assertEquals(dummyCreateDate, vuln2.getCreateDate());

        Vulnerability vuln3 = new Vulnerability(dummyCveId, dummyPubDate, dummyModDate);
        Assertions.assertEquals(dummyCveId, vuln3.getCveId());
        Assertions.assertEquals(dummyPubDate, vuln3.getPublishDate());
        Assertions.assertEquals(dummyModDate, vuln3.getLastModifiedDate());


    }

    @Test
    void getCveId() {
        Vulnerability vuln = genVuln();
        Assertions.assertEquals(dummyCveId, vuln.getCveId());
    }

    @Test
    void getDescription() {
        Vulnerability vuln = genVuln();
        Assertions.assertEquals(dummyDescription, vuln.getDescription());
    }

    @Test
    void getPublishDate() {
        Vulnerability vuln = genVuln();
        Assertions.assertEquals(dummyPubDate, vuln.getPublishDate());
    }

    @Test
    void getLastModifiedDate() {
        Vulnerability vuln = genVuln();
        Assertions.assertEquals(dummyModDate, vuln.getLastModifiedDate());
    }

    @Test
    void getCreateDate() {
        Vulnerability vuln = genVuln();
        Assertions.assertEquals(dummyCreateDate, vuln.getCreateDate());
    }
}