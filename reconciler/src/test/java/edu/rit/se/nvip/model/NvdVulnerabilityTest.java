package edu.rit.se.nvip.model;

import org.junit.Assert;
import org.junit.Test;

import java.sql.Timestamp;
import java.util.ArrayList;

import static org.junit.Assert.assertEquals;

/**
 * Tests for NvdVulnerability Model
 */
public class NvdVulnerabilityTest {

    /**
     * Tests to make sure that each Nvd Vulnerability properly is assigned the right NvdStatus
     */
    @Test
    public void testNvdVulnReceived() {

        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test", Timestamp.valueOf("2023-05-20 00:00:00"),"Received", new ArrayList<>());
        Assert.assertEquals("CVE-Test", testVuln.getCveId());
        Assert.assertEquals(Timestamp.valueOf("2023-05-20 00:00:00"), testVuln.getPublishDate());
        assertEquals(NvdVulnerability.NvdStatus.RECEIVED, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnUndergoingAnalysis() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"),"Undergoing Analysis", new ArrayList<>());
        assertEquals(NvdVulnerability.NvdStatus.UNDERGOING_ANALYSIS, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnAwaitingAnalysis() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"), "Awaiting Analysis", new ArrayList<>());
        assertEquals(NvdVulnerability.NvdStatus.AWAITING_ANALYSIS, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnAnalyzed() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"), "Analyzed", new ArrayList<>());
        assertEquals(NvdVulnerability.NvdStatus.ANALYZED, testVuln.getStatus());
    }

    @Test
    public void testNvdVulnNotInNvd() {
        NvdVulnerability testVuln = new NvdVulnerability("CVE-Test",  Timestamp.valueOf("2023-05-20 00:00:00"),"nostatus", new ArrayList<>());
        assertEquals(NvdVulnerability.NvdStatus.NOT_IN_NVD, testVuln.getStatus());
    }
}
