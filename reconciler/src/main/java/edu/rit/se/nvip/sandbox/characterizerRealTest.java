package edu.rit.se.nvip.sandbox;

import edu.rit.se.nvip.characterizer.CveCharacterizer;
import edu.rit.se.nvip.db.model.CompositeVulnerability;
import edu.rit.se.nvip.db.model.RawVulnerability;
import edu.rit.se.nvip.utils.ReconcilerEnvVars;

import java.sql.Timestamp;
import java.util.*;

public class characterizerRealTest {
    private Timestamp offset(int nHours) {
        return new Timestamp(System.currentTimeMillis() + nHours*3600L*1000);
    }


    public static void main(String[] args){
        RawVulnerability vuln = new RawVulnerability(
                1,
                "CVE-2023-8374",
                "Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3567-01 Red Hat Security Advisory 2023-3567-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3560-01 Red Hat Security Advisory 2023-3560-01 - Mozilla Firefox is an open-source web browser, designed for standards compliance, performance, and portability. This update upgrades Firefox to version 102.12.0 ESR. Red Hat Security Advisory 2023-3566-01 Red Hat Security Advisory 2023-3566-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3565-01 Red Hat Security Advisory 2023-3565-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Red Hat Security Advisory 2023-3564-01 Red Hat Security Advisory 2023-3564-01 - Mozilla Thunderbird is a standalone mail and newsgroup client. This update upgrades Thunderbird to version 102.12.0. Ubuntu Security Notice USN-6143-2 Ubuntu Security Notice 6143-2 - USN-6143-1 fixed vulnerabilities in Firefox. The update introduced several minor regressions. This update fixes the problem. Multiple security issues were discovered in Firefox. If a user were tricked into opening a specially crafted website, an attacker could potentially exploit these to cause a denial of service, obtain sensitive information across domains, or execute arbitrary code. Jun Kokatsu discovered that Firefox did not properly validate site-isolated process for a document loaded from a data: URL that was the result of a redirect, leading to an open redirect attack. An attacker could possibly use this issue to perform phishing attacks. Debian Security Advisory 5423-1 Debian Linux Security Advisory 5423-1 - Multiple security issues were discovered in Thunderbird, which could result in denial of service or the execution of arbitrary code. ick-to-Run): CVE-2023-33133: Remote Code Execution Vulnerability Published: June 13, 2023 | Severity: 4 vulnerability Explore FreeBSD: VID-1567BE8C-0A15-11EE-8290-A8A1599412C6 (CVE-2023-3214): chromium -- multiple vulnerabilities Published: June 13, 2023 | Severity: 4 vulnerability Explore Red Hat: CVE-2023-34416: Important: thunderbird security update (Multiple Advisories) Published: June 12, 2023 | Severity: 4 vulnerability Explore CentOS Linux: CVE-2023-34414: Important: thunderbird security update (Multiple Advisories) Published: June 12, 2023 | Severity: 4 vulnerability Explore FreeBSD: V nagement tool InsightVM. The exploits are all included in the Metasploit framework and utilized by our penetration testing tool, Metasploit Pro. Our vulnerability and exploit database is updated frequently and contains the most recent security research. Results 121 - 140 of 231,583 in total Debian: CVE-2023-34416: firefox-esr, thunderbird -- security update Published: June 09, 2023 | Severity: 4 vulnerability Explore Progress MOVEit Transfer Critical Vulnerability (CVE-2023-35036): SQL Injection (Remote) Published: June 09, 2023 | Severity: 10 vulnerability Explore OS X update for Sandbox (CVE",
                new Timestamp(System.currentTimeMillis() + -1*3600L*1000),
                new Timestamp(System.currentTimeMillis() + 3600L*1000),
                new Timestamp(System.currentTimeMillis() + -10*3600L*1000),
                "example.com");

        RawVulnerability vuln2 = new RawVulnerability(
                1,
                "CVE-2023-8375",
                "5Exploitability:UnprovenConsequences:Obtain Information DESCRIPTION__________Makves DCAP could allow a remote attacker to obtain sensitive information, caused by the cleartext transmission of configured credentials. By sniffingâ€¦ Vulnerabilities Zoho ManageEngine ADSelfService Plus security bypass | CVE-2023-35719 Jun 23, 2023 NAME__________Zoho ManageEngine ADSelfService Plus security bypassPlatforms Affected:Zoho ManageEngine ADSelfService PlusRisk Level:6.8Exploitability:UnprovenConsequences:Bypass Security DESCRIPTION__________Zoho ManageEngine ADSelfService Plus could allow a physical atta",
                new Timestamp(System.currentTimeMillis() + -2*3600L*1000),
                new Timestamp(System.currentTimeMillis() + 3600L*1000),
                new Timestamp(System.currentTimeMillis() + -10*3600L*1000),
                "example2.com");

        CompositeVulnerability compVuln = new CompositeVulnerability(vuln);
        CompositeVulnerability compVuln2 = new CompositeVulnerability(vuln2);

        String[] trainingDataInfo = {ReconcilerEnvVars.getTrainingDataDir(), ReconcilerEnvVars.getTrainingData()};
        CveCharacterizer characterizer = new CveCharacterizer(trainingDataInfo[0], trainingDataInfo[1], ReconcilerEnvVars.getCharacterizationApproach(),
                ReconcilerEnvVars.getCharacterizationMethod(), null); // TODO: Add/mock DBH


        Set<CompositeVulnerability> cveSet = new HashSet<>();
        cveSet.add(compVuln);
        cveSet.add(compVuln2);

        characterizer.characterizeCveList(cveSet,
                ReconcilerEnvVars.getCharacterizationLimit());

        System.out.println(compVuln.getVdoCharacteristics());
        System.out.println(compVuln.getCvssScoreInfo());

        System.out.println(compVuln2.getVdoCharacteristics());
        System.out.println(compVuln2.getCvssScoreInfo());
    }
}
