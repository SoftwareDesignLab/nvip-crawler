package edu.rit.se.nvip.model;


import java.sql.Timestamp;

/**
 * MITRE Vulnerability Object, used for comparing w/ MITRE
 */
public class MitreVulnerability extends Vulnerability {

    /**
     * 3 main status types to track
     *
     * In MITRE --> CVE is fully analyzed and is in MITRE
     * Reserved --> CVE is in MITRE, but it is reserved
     * Not in MITRE --> CVE is not in MITRE
     */
    public enum mitreStatus {
        PUBLISHED("Published"),
        RESERVED("Reserved"),
        NOTINMITRE("Not in Mitre");

        public final String status;
        mitreStatus(String status) {
            this.status = status;
        }
    }

    private MitreVulnerability.mitreStatus status;


    public MitreVulnerability(String cveId, Timestamp publishDate, Timestamp lastModifiedDate, String status) {
        super(cveId, publishDate, lastModifiedDate);

        switch (status.replace("\"", "")) {
            case ("PUBLISHED"): {
                this.status = mitreStatus.PUBLISHED;
                break;
            }
            case ("PUBLIC"): {
                this.status = mitreStatus.PUBLISHED;
                break;
            }
            case ("RESERVED"): {
                this.status = mitreStatus.RESERVED;
                break;
            }
            default: {
                this.status = mitreStatus.NOTINMITRE;
                break;
            }
        }
    }

    /**
     * Getter for status in MITRE
     * @return
     */
    public MitreVulnerability.mitreStatus getStatus() {
        return status;
    }

    @Override
    public String toString() {
        return this.cveId + " || " + this.publishDate + " || " + status;
    }



}
